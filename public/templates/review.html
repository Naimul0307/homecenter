<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/review.css">
    <link rel="stylesheet" href="../css/receipt.css">
    <title>HomeCentre - Review</title>
</head>
<body>
    <div class="review-container">
        <div class="review-header">
            <img src="https://via.placeholder.com/150" alt="Homecentre Logo" class="logo">
            <h1 class="review-title">homecentre</h1>
        </div>

        <div class="review-body">
            <p class="message">The Heart of Every Home Beats with You</p>
            <p class="description">Behind every cozy space, every cherished memory, and every heartwarming moment is you, the woman who makes it all possible.</p>
            <button class="confirm-button" id="review-confirm-btn">REVIEW AND CONFIRM</button>
        </div>
    </div>

    
    <!-- Hidden Receipt Popup -->
    <div class="overlay" id="overlay">
        <div class="receipt-container" id="receipt-container">
            <div class="receipt-content">
                <button class="close-btn" id="close-btn">&times;</button> <!-- Close Button -->
    
                <div class="receipt-header">
                    <img src="https://via.placeholder.com/150" alt="Homecentre Logo" class="logo">
                    <h1 class="receipt-title">homecentre</h1>
                </div>
    
                <hr class="divider">
                
                <div class="receipt-body">
                    <p class="greeting">Dear Arja</p>
                    <p class="thank-you">Thank you for</p>
                    <ul class="items-list">

                    </ul>
        
                    <hr class="divider">
        
                    <p class="total">Total : <span class="price">PRICELESS</span></p>
        
                    <hr class="divider">
        
                    <p class="tribute">This isn’t just a receipt. It’s a tribute.</p>
                    <p class="tribute-text">To the love, the sacrifices, the strength that hold homes together.</p>
                    <p class="you-are">YOU are seen. YOU are valued. YOU are extraordinary.</p>
                </div>
                <div class="footer">
                    <img src="https://via.placeholder.com/150x50" alt="Footer Pattern" class="footer-pattern">
                </div>
            </div>
        </div>
    
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Ensure the receipt and overlay are hidden on page load
            document.getElementById("receipt-container").style.display = "none";
            document.getElementById("overlay").style.display = "none";

            // Get all user contributions data from localStorage
            const storedAllUserContributions = localStorage.getItem("allUserContributions");

            let userName = "Dear User";
            let selectedContributions = [];

            // Parse the data from localStorage
            if (storedAllUserContributions) {
                try {
                    const allUserContributionsData = JSON.parse(storedAllUserContributions);
                    if (allUserContributionsData.length > 0) {
                        // Get the last user's data
                        const lastUserData = allUserContributionsData[allUserContributionsData.length - 1];
                        userName = lastUserData.name || "Dear User";
                        selectedContributions = lastUserData.contributions || [];
                    }
                } catch (e) {
                    console.error("Error parsing user contributions:", e);
                    selectedContributions = [];
                }
            }

            // Debugging: Log the parsed data
            console.log("User Name:", userName);
            console.log("Contributions:", selectedContributions);

            // Update the greeting with the user's name
            document.querySelector(".greeting").textContent = `Dear ${userName}`;

            // Update the items list with selected contributions
            const itemsList = document.querySelector(".items-list");
            itemsList.innerHTML = ""; // Clear existing list

            if (selectedContributions.length > 0) {
                selectedContributions.forEach(contribution => {
                    const listItem = document.createElement("li");
                    listItem.textContent = contribution;
                    itemsList.appendChild(listItem);
                });
            } else {
                // If no contributions found, show default text
                const listItem = document.createElement("li");
                listItem.textContent = "No contributions selected.";
                itemsList.appendChild(listItem);
            }

            // Show the receipt popup and overlay on button click
            document.getElementById("review-confirm-btn").addEventListener("click", function () {
                document.getElementById("receipt-container").style.display = "flex";
                document.getElementById("overlay").style.display = "block";
            });

            // Close the receipt popup and overlay
            document.getElementById("close-btn").addEventListener("click", function () {
                document.getElementById("receipt-container").style.display = "none";
                document.getElementById("overlay").style.display = "none";
            });
        });

    </script>
    
</body>
</html>
